<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Visualising data in the tidyverse | R notes</title>
  <meta name="description" content="These are some notes on using R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Visualising data in the tidyverse | R notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are some notes on using R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Visualising data in the tidyverse | R notes" />
  
  <meta name="twitter:description" content="These are some notes on using R" />
  

<meta name="author" content="Andi Fugard" />


<meta name="date" content="2020-11-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="starting-r.html"/>
<link rel="next" href="linear-regression.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="libs/table1-1.0/table1_defaults.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="starting-r.html"><a href="starting-r.html"><i class="fa fa-check"></i><b>2</b> Starting R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="starting-r.html"><a href="starting-r.html#arithmetic"><i class="fa fa-check"></i><b>2.1</b> Arithmetic</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="starting-r.html"><a href="starting-r.html#activities"><i class="fa fa-check"></i><b>2.1.1</b> Activities</a></li>
<li class="chapter" data-level="2.1.2" data-path="starting-r.html"><a href="starting-r.html#answers"><i class="fa fa-check"></i><b>2.1.2</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="starting-r.html"><a href="starting-r.html#variables"><i class="fa fa-check"></i><b>2.2</b> Variables</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="starting-r.html"><a href="starting-r.html#activity"><i class="fa fa-check"></i><b>2.2.1</b> Activity</a></li>
<li class="chapter" data-level="2.2.2" data-path="starting-r.html"><a href="starting-r.html#answer"><i class="fa fa-check"></i><b>2.2.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="starting-r.html"><a href="starting-r.html#a-note-on-variable-names"><i class="fa fa-check"></i><b>2.3</b> A note on variable names</a></li>
<li class="chapter" data-level="2.4" data-path="starting-r.html"><a href="starting-r.html#vectors"><i class="fa fa-check"></i><b>2.4</b> Vectors</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="starting-r.html"><a href="starting-r.html#activity-1"><i class="fa fa-check"></i><b>2.4.1</b> Activity</a></li>
<li class="chapter" data-level="2.4.2" data-path="starting-r.html"><a href="starting-r.html#answer-1"><i class="fa fa-check"></i><b>2.4.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="starting-r.html"><a href="starting-r.html#functions"><i class="fa fa-check"></i><b>2.5</b> Functions</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="starting-r.html"><a href="starting-r.html#activity-2"><i class="fa fa-check"></i><b>2.5.1</b> Activity</a></li>
<li class="chapter" data-level="2.5.2" data-path="starting-r.html"><a href="starting-r.html#answer-2"><i class="fa fa-check"></i><b>2.5.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="starting-r.html"><a href="starting-r.html#more-functions"><i class="fa fa-check"></i><b>2.6</b> More functions</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="starting-r.html"><a href="starting-r.html#activity-3"><i class="fa fa-check"></i><b>2.6.1</b> Activity</a></li>
<li class="chapter" data-level="2.6.2" data-path="starting-r.html"><a href="starting-r.html#answer-3"><i class="fa fa-check"></i><b>2.6.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="starting-r.html"><a href="starting-r.html#data-frames"><i class="fa fa-check"></i><b>2.7</b> Data frames</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="starting-r.html"><a href="starting-r.html#activity-4"><i class="fa fa-check"></i><b>2.7.1</b> Activity</a></li>
<li class="chapter" data-level="2.7.2" data-path="starting-r.html"><a href="starting-r.html#answer-4"><i class="fa fa-check"></i><b>2.7.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="starting-r.html"><a href="starting-r.html#loading-data-frames-from-a-file"><i class="fa fa-check"></i><b>2.8</b> Loading data frames from a file</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="starting-r.html"><a href="starting-r.html#activity-5"><i class="fa fa-check"></i><b>2.8.1</b> Activity</a></li>
<li class="chapter" data-level="2.8.2" data-path="starting-r.html"><a href="starting-r.html#answer-5"><i class="fa fa-check"></i><b>2.8.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="starting-r.html"><a href="starting-r.html#packages"><i class="fa fa-check"></i><b>2.9</b> Packages</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="starting-r.html"><a href="starting-r.html#activity-6"><i class="fa fa-check"></i><b>2.9.1</b> Activity</a></li>
<li class="chapter" data-level="2.9.2" data-path="starting-r.html"><a href="starting-r.html#answer-6"><i class="fa fa-check"></i><b>2.9.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="starting-r.html"><a href="starting-r.html#the-end"><i class="fa fa-check"></i><b>2.10</b> The end!</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Visualising data in the tidyverse</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#getting-setup"><i class="fa fa-check"></i><b>3.1</b> Getting setup</a></li>
<li class="chapter" data-level="3.2" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#an-interlude-on-functions"><i class="fa fa-check"></i><b>3.2</b> An interlude on functions</a></li>
<li class="chapter" data-level="3.3" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#a-scatterplot-in-ggplot"><i class="fa fa-check"></i><b>3.3</b> A scatterplot in ggplot</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#warm-up-activity"><i class="fa fa-check"></i><b>3.3.1</b> Warm-up activity</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#answer-7"><i class="fa fa-check"></i><b>3.3.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#another-aesthetic-colour"><i class="fa fa-check"></i><b>3.4</b> Another aesthetic: colour</a></li>
<li class="chapter" data-level="3.5" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#another-geom-jitter"><i class="fa fa-check"></i><b>3.5</b> Another geom: jitter</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#activity-to-develop-your-help-searching-skill"><i class="fa fa-check"></i><b>3.5.1</b> Activity to develop your help-searching skill!</a></li>
<li class="chapter" data-level="3.5.2" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#answer-8"><i class="fa fa-check"></i><b>3.5.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#aggregatingsummarising-data-by-group"><i class="fa fa-check"></i><b>3.6</b> Aggregating/summarising data by group</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#activity-7"><i class="fa fa-check"></i><b>3.6.1</b> Activity</a></li>
<li class="chapter" data-level="3.6.2" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#answer-9"><i class="fa fa-check"></i><b>3.6.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#pipes"><i class="fa fa-check"></i><b>3.7</b> Pipes</a></li>
<li class="chapter" data-level="3.8" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#plot-the-mean-life-expectancy-by-continent"><i class="fa fa-check"></i><b>3.8</b> Plot the mean life expectancy by continent</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#actvity"><i class="fa fa-check"></i><b>3.8.1</b> Actvity</a></li>
<li class="chapter" data-level="3.8.2" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#answer-10"><i class="fa fa-check"></i><b>3.8.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#yet-another-geom-line"><i class="fa fa-check"></i><b>3.9</b> Yet another geom: line</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#activity-8"><i class="fa fa-check"></i><b>3.9.1</b> Activity</a></li>
<li class="chapter" data-level="3.9.2" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#answer-11"><i class="fa fa-check"></i><b>3.9.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#filtering-data-along-the-pipeline"><i class="fa fa-check"></i><b>3.10</b> Filtering data along the pipeline</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#activity-9"><i class="fa fa-check"></i><b>3.10.1</b> Activity</a></li>
<li class="chapter" data-level="3.10.2" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#answer-12"><i class="fa fa-check"></i><b>3.10.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#other-handy-tools-select-slice-bind-and-arrange"><i class="fa fa-check"></i><b>3.11</b> Other handy tools: select, slice, bind, and arrange</a></li>
<li class="chapter" data-level="3.12" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#filtering-for-members-of-a-vector"><i class="fa fa-check"></i><b>3.12</b> Filtering for members of a vector</a></li>
<li class="chapter" data-level="3.13" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#final-challenge"><i class="fa fa-check"></i><b>3.13</b> Final challenge</a>
<ul>
<li class="chapter" data-level="3.13.1" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#activity-10"><i class="fa fa-check"></i><b>3.13.1</b> Activity</a></li>
<li class="chapter" data-level="3.13.2" data-path="visualising-data-in-the-tidyverse.html"><a href="visualising-data-in-the-tidyverse.html#answer-13"><i class="fa fa-check"></i><b>3.13.2</b> Answer</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>4</b> Linear regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="linear-regression.html"><a href="linear-regression.html#before-we-begin"><i class="fa fa-check"></i><b>4.1</b> Before we begin</a></li>
<li class="chapter" data-level="4.2" data-path="linear-regression.html"><a href="linear-regression.html#the-dataset"><i class="fa fa-check"></i><b>4.2</b> The dataset</a></li>
<li class="chapter" data-level="4.3" data-path="linear-regression.html"><a href="linear-regression.html#interlude-on-methodology"><i class="fa fa-check"></i><b>4.3</b> Interlude on methodology</a></li>
<li class="chapter" data-level="4.4" data-path="linear-regression.html"><a href="linear-regression.html#descriptives"><i class="fa fa-check"></i><b>4.4</b> Descriptives</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="linear-regression.html"><a href="linear-regression.html#activity-11"><i class="fa fa-check"></i><b>4.4.1</b> Activity</a></li>
<li class="chapter" data-level="4.4.2" data-path="linear-regression.html"><a href="linear-regression.html#answer-14"><i class="fa fa-check"></i><b>4.4.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="linear-regression.html"><a href="linear-regression.html#prep-to-understand-the-simplest-regression-model"><i class="fa fa-check"></i><b>4.5</b> Prep to understand the simplest regression model</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="linear-regression.html"><a href="linear-regression.html#activity-12"><i class="fa fa-check"></i><b>4.5.1</b> Activity</a></li>
<li class="chapter" data-level="4.5.2" data-path="linear-regression.html"><a href="linear-regression.html#answer-15"><i class="fa fa-check"></i><b>4.5.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="linear-regression.html"><a href="linear-regression.html#the-simplest-regression-model-intercept-only-model"><i class="fa fa-check"></i><b>4.6</b> The simplest regression model: intercept only model</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="linear-regression.html"><a href="linear-regression.html#activity-13"><i class="fa fa-check"></i><b>4.6.1</b> Activity</a></li>
<li class="chapter" data-level="4.6.2" data-path="linear-regression.html"><a href="linear-regression.html#answer-16"><i class="fa fa-check"></i><b>4.6.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="linear-regression.html"><a href="linear-regression.html#adding-a-slope-to-the-regression-model"><i class="fa fa-check"></i><b>4.7</b> Adding a slope to the regression model</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="linear-regression.html"><a href="linear-regression.html#activity-14"><i class="fa fa-check"></i><b>4.7.1</b> Activity</a></li>
<li class="chapter" data-level="4.7.2" data-path="linear-regression.html"><a href="linear-regression.html#answer-17"><i class="fa fa-check"></i><b>4.7.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="linear-regression.html"><a href="linear-regression.html#residuals"><i class="fa fa-check"></i><b>4.8</b> Residuals</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="linear-regression.html"><a href="linear-regression.html#activity-15"><i class="fa fa-check"></i><b>4.8.1</b> Activity</a></li>
<li class="chapter" data-level="4.8.2" data-path="linear-regression.html"><a href="linear-regression.html#answer-18"><i class="fa fa-check"></i><b>4.8.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="linear-regression.html"><a href="linear-regression.html#comparing-models"><i class="fa fa-check"></i><b>4.9</b> Comparing models</a></li>
<li class="chapter" data-level="4.10" data-path="linear-regression.html"><a href="linear-regression.html#regression-with-two-or-more-predictors"><i class="fa fa-check"></i><b>4.10</b> Regression with two or more predictors</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="linear-regression.html"><a href="linear-regression.html#activity-16"><i class="fa fa-check"></i><b>4.10.1</b> Activity</a></li>
<li class="chapter" data-level="4.10.2" data-path="linear-regression.html"><a href="linear-regression.html#answer-19"><i class="fa fa-check"></i><b>4.10.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="linear-regression.html"><a href="linear-regression.html#interpreting-regression-models-with-two-or-more-predictors"><i class="fa fa-check"></i><b>4.11</b> Interpreting regression models with two or more predictors</a></li>
<li class="chapter" data-level="4.12" data-path="linear-regression.html"><a href="linear-regression.html#optional-that-pesky-negative-intercept"><i class="fa fa-check"></i><b>4.12</b> Optional: that pesky negative intercept</a>
<ul>
<li class="chapter" data-level="4.12.1" data-path="linear-regression.html"><a href="linear-regression.html#activity-17"><i class="fa fa-check"></i><b>4.12.1</b> Activity</a></li>
<li class="chapter" data-level="4.12.2" data-path="linear-regression.html"><a href="linear-regression.html#answer-20"><i class="fa fa-check"></i><b>4.12.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="linear-regression.html"><a href="linear-regression.html#finally-confidence-intervals"><i class="fa fa-check"></i><b>4.13</b> Finally: confidence intervals</a></li>
<li class="chapter" data-level="4.14" data-path="linear-regression.html"><a href="linear-regression.html#very-optional-extras"><i class="fa fa-check"></i><b>4.14</b> Very optional extras</a>
<ul>
<li class="chapter" data-level="4.14.1" data-path="linear-regression.html"><a href="linear-regression.html#making-functions"><i class="fa fa-check"></i><b>4.14.1</b> Making functions</a></li>
<li class="chapter" data-level="4.14.2" data-path="linear-regression.html"><a href="linear-regression.html#another-way-to-make-scatterplots-ggally"><i class="fa fa-check"></i><b>4.14.2</b> Another way to make scatterplots: GGally</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html"><i class="fa fa-check"></i><b>5</b> Linear regression diagnostics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#before-we-begin-1"><i class="fa fa-check"></i><b>5.1</b> Before we begin</a></li>
<li class="chapter" data-level="5.2" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#the-dataset-1"><i class="fa fa-check"></i><b>5.2</b> The dataset</a></li>
<li class="chapter" data-level="5.3" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#fit-a-regression-model"><i class="fa fa-check"></i><b>5.3</b> Fit a regression model</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#activity-18"><i class="fa fa-check"></i><b>5.3.1</b> Activity</a></li>
<li class="chapter" data-level="5.3.2" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#answer-21"><i class="fa fa-check"></i><b>5.3.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#checking-for-normally-distributed-residuals"><i class="fa fa-check"></i><b>5.4</b> Checking for normally distributed residuals</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#base-r-histogram"><i class="fa fa-check"></i><b>5.4.1</b> Base R histogram</a></li>
<li class="chapter" data-level="5.4.2" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#quantile-comparison-plot"><i class="fa fa-check"></i><b>5.4.2</b> Quantile-comparison plot</a></li>
<li class="chapter" data-level="5.4.3" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#statistical-test-of-normality"><i class="fa fa-check"></i><b>5.4.3</b> Statistical test of normality</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#checking-constant-residual-variance"><i class="fa fa-check"></i><b>5.5</b> Checking constant residual variance</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#activity-20"><i class="fa fa-check"></i><b>5.5.1</b> Activity</a></li>
<li class="chapter" data-level="5.5.2" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#answer-23"><i class="fa fa-check"></i><b>5.5.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#checking-for-relationships-between-residuals-and-predicted-outcome-or-predictors"><i class="fa fa-check"></i><b>5.6</b> Checking for relationships between residuals and predicted outcome or predictors</a></li>
<li class="chapter" data-level="5.7" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#checking-linearity"><i class="fa fa-check"></i><b>5.7</b> Checking linearity</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#what-should-be-linear-in-a-linear-model"><i class="fa fa-check"></i><b>5.7.1</b> What should be linear in a linear model?</a></li>
<li class="chapter" data-level="5.7.2" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#checking-for-linearity"><i class="fa fa-check"></i><b>5.7.2</b> Checking for linearity</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#checking-influence-leave-one-out-analyses"><i class="fa fa-check"></i><b>5.8</b> Checking influence: leave-one-out analyses</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#residual-outliers"><i class="fa fa-check"></i><b>5.8.1</b> Residual outliers</a></li>
<li class="chapter" data-level="5.8.2" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#cooks-distance"><i class="fa fa-check"></i><b>5.8.2</b> Cook’s distance</a></li>
<li class="chapter" data-level="5.8.3" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#dfbeta-and-close-sibling-dfbetas"><i class="fa fa-check"></i><b>5.8.3</b> DFBETA and (close sibling) DFBETAS</a></li>
<li class="chapter" data-level="5.8.4" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#view-them-all"><i class="fa fa-check"></i><b>5.8.4</b> View them all</a></li>
<li class="chapter" data-level="5.8.5" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#so-er-what-should-we-do-with-potentially-influential-observations"><i class="fa fa-check"></i><b>5.8.5</b> So, er, what should we do with “potentially influential” observations…?</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#checking-the-variance-inflation-factors-vifs"><i class="fa fa-check"></i><b>5.9</b> Checking the variance inflation factors (VIFs)</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#activity-22"><i class="fa fa-check"></i><b>5.9.1</b> Activity</a></li>
<li class="chapter" data-level="5.9.2" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#answer-25"><i class="fa fa-check"></i><b>5.9.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#the-challenge"><i class="fa fa-check"></i><b>5.10</b> The challenge</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#activity-23"><i class="fa fa-check"></i><b>5.10.1</b> Activity</a></li>
<li class="chapter" data-level="5.10.2" data-path="linear-regression-diagnostics.html"><a href="linear-regression-diagnostics.html#answer-26"><i class="fa fa-check"></i><b>5.10.2</b> Answer</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html"><i class="fa fa-check"></i><b>6</b> Categorical predictors and interactions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#before-we-begin-2"><i class="fa fa-check"></i><b>6.1</b> Before we begin</a></li>
<li class="chapter" data-level="6.2" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#the-dataset-2"><i class="fa fa-check"></i><b>6.2</b> The dataset</a></li>
<li class="chapter" data-level="6.3" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#factors"><i class="fa fa-check"></i><b>6.3</b> Factors</a></li>
<li class="chapter" data-level="6.4" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#visualising-the-data"><i class="fa fa-check"></i><b>6.4</b> Visualising the data</a></li>
<li class="chapter" data-level="6.5" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#the-punchline-occupation-type-does-predict-prestige"><i class="fa fa-check"></i><b>6.5</b> The punchline: occupation type does predict prestige</a></li>
<li class="chapter" data-level="6.6" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#understanding-factors-in-regression-models"><i class="fa fa-check"></i><b>6.6</b> Understanding factors in regression models</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#how-are-categorical-variables-encoded"><i class="fa fa-check"></i><b>6.6.1</b> How are categorical variables encoded?</a></li>
<li class="chapter" data-level="6.6.2" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#how-are-binary-two-level-categorical-predictors-encoded"><i class="fa fa-check"></i><b>6.6.2</b> How are binary (two-level) categorical predictors encoded?</a></li>
<li class="chapter" data-level="6.6.3" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#categorical-predictors-with-3-or-more-levels"><i class="fa fa-check"></i><b>6.6.3</b> Categorical predictors with 3 or more levels</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#interpreting-the-coefficients"><i class="fa fa-check"></i><b>6.7</b> Interpreting the coefficients</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#activity-25"><i class="fa fa-check"></i><b>6.7.1</b> Activity</a></li>
<li class="chapter" data-level="6.7.2" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#answer-28"><i class="fa fa-check"></i><b>6.7.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#checking-all-combinations"><i class="fa fa-check"></i><b>6.8</b> Checking all combinations</a></li>
<li class="chapter" data-level="6.9" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#the-intercept-is-not-always-the-mean-of-the-comparison-group"><i class="fa fa-check"></i><b>6.9</b> The intercept is not always the mean of the comparison group</a></li>
<li class="chapter" data-level="6.10" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#recap"><i class="fa fa-check"></i><b>6.10</b> Recap</a></li>
<li class="chapter" data-level="6.11" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#challenge"><i class="fa fa-check"></i><b>6.11</b> Challenge</a>
<ul>
<li class="chapter" data-level="6.11.1" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#activity-26"><i class="fa fa-check"></i><b>6.11.1</b> Activity</a></li>
<li class="chapter" data-level="6.11.2" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#answers-1"><i class="fa fa-check"></i><b>6.11.2</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="6.12" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#brief-introduction-to-interactions"><i class="fa fa-check"></i><b>6.12</b> Brief introduction to interactions</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#what-is-an-interaction"><i class="fa fa-check"></i><b>6.12.1</b> What is an interaction?</a></li>
<li class="chapter" data-level="6.12.2" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#how-to-test-for-interactions-in-r"><i class="fa fa-check"></i><b>6.12.2</b> How to test for interactions in R</a></li>
<li class="chapter" data-level="6.12.3" data-path="categorical-predictors-and-interactions.html"><a href="categorical-predictors-and-interactions.html#understanding-interactions"><i class="fa fa-check"></i><b>6.12.3</b> Understanding interactions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>7</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="logistic-regression.html"><a href="logistic-regression.html#setup"><i class="fa fa-check"></i><b>7.1</b> Setup</a></li>
<li class="chapter" data-level="7.2" data-path="logistic-regression.html"><a href="logistic-regression.html#the-dataset-3"><i class="fa fa-check"></i><b>7.2</b> The dataset</a></li>
<li class="chapter" data-level="7.3" data-path="logistic-regression.html"><a href="logistic-regression.html#warmup-activity"><i class="fa fa-check"></i><b>7.3</b> Warmup activity</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#activity-27"><i class="fa fa-check"></i><b>7.3.1</b> Activity</a></li>
<li class="chapter" data-level="7.3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#answer-29"><i class="fa fa-check"></i><b>7.3.2</b> Answer</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="logistic-regression.html"><a href="logistic-regression.html#the-punchline"><i class="fa fa-check"></i><b>7.4</b> The punchline</a></li>
<li class="chapter" data-level="7.5" data-path="logistic-regression.html"><a href="logistic-regression.html#intermezzo-parametric-versus-nonparametric"><i class="fa fa-check"></i><b>7.5</b> Intermezzo: parametric versus nonparametric</a></li>
<li class="chapter" data-level="7.6" data-path="logistic-regression.html"><a href="logistic-regression.html#glms"><i class="fa fa-check"></i><b>7.6</b> What is a generalised linear model?</a></li>
<li class="chapter" data-level="7.7" data-path="logistic-regression.html"><a href="logistic-regression.html#what-is-the-log-function-again"><i class="fa fa-check"></i><b>7.7</b> What is the log function again…?</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="logistic-regression.html"><a href="logistic-regression.html#log-arithmetic"><i class="fa fa-check"></i><b>7.7.1</b> The arithmetic</a></li>
<li class="chapter" data-level="7.7.2" data-path="logistic-regression.html"><a href="logistic-regression.html#why-log"><i class="fa fa-check"></i><b>7.7.2</b> Why log?</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="logistic-regression.html"><a href="logistic-regression.html#intercept-only-models-again"><i class="fa fa-check"></i><b>7.8</b> Intercept-only models again</a></li>
<li class="chapter" data-level="7.9" data-path="logistic-regression.html"><a href="logistic-regression.html#odds-and-log-odds"><i class="fa fa-check"></i><b>7.9</b> Odds and log odds</a></li>
<li class="chapter" data-level="7.10" data-path="logistic-regression.html"><a href="logistic-regression.html#back-to-that-intercept"><i class="fa fa-check"></i><b>7.10</b> Back to that intercept</a></li>
<li class="chapter" data-level="7.11" data-path="logistic-regression.html"><a href="logistic-regression.html#interpret-slopes"><i class="fa fa-check"></i><b>7.11</b> Interpreting model slopes</a>
<ul>
<li class="chapter" data-level="7.11.1" data-path="logistic-regression.html"><a href="logistic-regression.html#interpret-on-the-log-odds-scale"><i class="fa fa-check"></i><b>7.11.1</b> Interpret on the log-odds scale</a></li>
<li class="chapter" data-level="7.11.2" data-path="logistic-regression.html"><a href="logistic-regression.html#interpret-using-the-divide-by-4-approximation"><i class="fa fa-check"></i><b>7.11.2</b> Interpret using the “divide-by-4” approximation</a></li>
<li class="chapter" data-level="7.11.3" data-path="logistic-regression.html"><a href="logistic-regression.html#interpret-using-odds"><i class="fa fa-check"></i><b>7.11.3</b> Interpret using odds</a></li>
<li class="chapter" data-level="7.11.4" data-path="logistic-regression.html"><a href="logistic-regression.html#interpret-using-predicted-probabilities"><i class="fa fa-check"></i><b>7.11.4</b> Interpret using predicted probabilities</a></li>
</ul></li>
<li class="chapter" data-level="7.12" data-path="logistic-regression.html"><a href="logistic-regression.html#diagnostics"><i class="fa fa-check"></i><b>7.12</b> Diagnostics</a>
<ul>
<li class="chapter" data-level="7.12.1" data-path="logistic-regression.html"><a href="logistic-regression.html#check-the-residual-distribution"><i class="fa fa-check"></i><b>7.12.1</b> Check the residual distribution</a></li>
<li class="chapter" data-level="7.12.2" data-path="logistic-regression.html"><a href="logistic-regression.html#check-that-the-residual-mean-is-constant"><i class="fa fa-check"></i><b>7.12.2</b> Check that the residual mean is constant</a></li>
<li class="chapter" data-level="7.12.3" data-path="logistic-regression.html"><a href="logistic-regression.html#linearity-of-predictors"><i class="fa fa-check"></i><b>7.12.3</b> Linearity of predictors</a></li>
<li class="chapter" data-level="7.12.4" data-path="logistic-regression.html"><a href="logistic-regression.html#influence"><i class="fa fa-check"></i><b>7.12.4</b> Influence</a></li>
<li class="chapter" data-level="7.12.5" data-path="logistic-regression.html"><a href="logistic-regression.html#multicolinearity"><i class="fa fa-check"></i><b>7.12.5</b> Multicolinearity</a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="logistic-regression.html"><a href="logistic-regression.html#a-challenge"><i class="fa fa-check"></i><b>7.13</b> A challenge</a>
<ul>
<li class="chapter" data-level="7.13.1" data-path="logistic-regression.html"><a href="logistic-regression.html#activity-31"><i class="fa fa-check"></i><b>7.13.1</b> Activity</a></li>
<li class="chapter" data-level="7.13.2" data-path="logistic-regression.html"><a href="logistic-regression.html#an-answer"><i class="fa fa-check"></i><b>7.13.2</b> (An) Answer</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mediation-analysis.html"><a href="mediation-analysis.html"><i class="fa fa-check"></i><b>8</b> Mediation analysis</a></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualising-data-in-the-tidyverse" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Visualising data in the tidyverse</h1>
<p>By the end of this tutorial you will:</p>
<ul>
<li>Have explored a key example visualisation in depth, using packages in the tidyverse.</li>
<li>Understand what happens when you tweak this in various ways.</li>
<li>Know where to look for ideas and code for other visualisations.</li>
</ul>
<div id="getting-setup" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Getting setup</h2>
<p>You will need to create a new <em>R</em> or Markdown (<em>Rmd</em>) file (depending on your preference – I recommend Markdown) and save it somewhere sensible where you can find it again in a few months time.</p>
<p>We will be using the <a href="https://github.com/jennybc/gapminder">Gapminder dataset</a> dataset from last time.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="visualising-data-in-the-tidyverse.html#cb62-1" aria-hidden="true" tabindex="-1"></a>gap <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;gapminder.csv&quot;</span>)</span></code></pre></div>
<p>Previously we used the “base” plot function:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="visualising-data-in-the-tidyverse.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lifeExp <span class="sc">~</span> year,</span>
<span id="cb63-2"><a href="visualising-data-in-the-tidyverse.html#cb63-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> gap,</span>
<span id="cb63-3"><a href="visualising-data-in-the-tidyverse.html#cb63-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb63-4"><a href="visualising-data-in-the-tidyverse.html#cb63-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Life expectancy at birth&quot;</span>)</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>We can do better than this.</p>
<p>A collection of packages called the <a href="https://www.tidyverse.org/">tidyverse</a> has become an industry standard in R (though see also <a href="https://github.com/matloff/TidyverseSkeptic/blob/master/READMEFull.md">an alternate view</a>).</p>
<p>This command will include tidyverse and make a bit of noise as it arrives…</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="visualising-data-in-the-tidyverse.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>If that didn’t work, there are two things you can do. You could try saving your R/Rmd file. This may prompt RStudio to notice that the package isn’t installed and ask you if you want to install it.</p>
<p>Alternatively, just use the <code>install.packages</code> command as per last week:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="visualising-data-in-the-tidyverse.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>To see if that worked, run this:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="visualising-data-in-the-tidyverse.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gap,</span>
<span id="cb66-2"><a href="visualising-data-in-the-tidyverse.html#cb66-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb66-3"><a href="visualising-data-in-the-tidyverse.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb66-4"><a href="visualising-data-in-the-tidyverse.html#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb66-5"><a href="visualising-data-in-the-tidyverse.html#cb66-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Life expectancy at birth&quot;</span>)</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>Ta-da: a graph! This used <code>ggplot</code>, which is part of the <code>ggplot2</code> package which, in turn, is part of <code>tidyverse</code>.</p>
<p>The rest of this tutorial will explore how to develop this into a more useful visualisation.</p>
</div>
<div id="an-interlude-on-functions" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> An interlude on functions</h2>
<p>Previously, I described R <em>functions</em> as magical computational machines which take inputs and transform them in some way, giving an output.</p>
<p>Above, we have seen that the output of a function can be a picture. It can also be a vibration (that’s how sounds are made) or anything else that can be plugged into a computer. It might be a humble number, like a mean.</p>
<p>Sometimes I’ll call functions “commands” and sometimes I’ll call the inputs “options” or “parameters” or “arguments.” Hopefully it will be clear from the context what I mean. If not, even after scratching your head, then do ask!</p>
</div>
<div id="a-scatterplot-in-ggplot" class="section level2 tabset" number="3.3">
<h2><span class="header-section-number">3.3</span> A scatterplot in ggplot</h2>
<p>Let’s build the previous example step-by-step.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="visualising-data-in-the-tidyverse.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gap,</span>
<span id="cb67-2"><a href="visualising-data-in-the-tidyverse.html#cb67-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp))</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>This first part tells <code>ggplot</code> what data to use and an aesthetic mapping. <em>Aesthetics</em> in tidyverse are properties of the objects in your plot and the mapping tells <code>ggplot</code> how those objects relate to your data. Two basic properties are <em>x</em> and <em>y</em> locations on a plot. Here they have been mapped to year and life expectancy, respectively.</p>
<p>When you run that code, you will see that nothing was actually done with the mappings. The next stage is to add a <em>geom</em> – a geometric object – for each row of data. That’s where the point geom, <code>geom_point</code>, comes in:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="visualising-data-in-the-tidyverse.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gap,</span>
<span id="cb68-2"><a href="visualising-data-in-the-tidyverse.html#cb68-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb68-3"><a href="visualising-data-in-the-tidyverse.html#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>Note how the “+” symbol is used here to mean adding elements to a plot. The meaning of “+” depends on context.</p>
<p>I could also have made this plot by giving a name to the first part:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="visualising-data-in-the-tidyverse.html#cb69-1" aria-hidden="true" tabindex="-1"></a>the_basic_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> gap,</span>
<span id="cb69-2"><a href="visualising-data-in-the-tidyverse.html#cb69-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp))</span></code></pre></div>
<p>Then added this to the geom:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="visualising-data-in-the-tidyverse.html#cb70-1" aria-hidden="true" tabindex="-1"></a>plot_with_stuff_on <span class="ot">&lt;-</span> the_basic_plot <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p>The plot hasn’t displayed yet, though.</p>
<div id="warm-up-activity" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Warm-up activity</h3>
<ol style="list-style-type: lower-alpha">
<li><p>What do you need to do to get the <code>plot_with_stuff_on</code> plot to display?</p></li>
<li><p>How could you change the axis labels on <code>plot_with_stuff_on</code>? (Look up for a clue!)</p></li>
</ol>
</div>
<div id="answer-7" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Answer</h3>
<ol style="list-style-type: lower-alpha">
<li>What do you need to do to get the plot to display?</li>
</ol>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="visualising-data-in-the-tidyverse.html#cb71-1" aria-hidden="true" tabindex="-1"></a>plot_with_stuff_on</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>How could you change the axis labels on <code>plot_with_stuff_on</code>?</li>
</ol>
<p>Either:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="visualising-data-in-the-tidyverse.html#cb72-1" aria-hidden="true" tabindex="-1"></a>plot_with_stuff_on <span class="sc">+</span> </span>
<span id="cb72-2"><a href="visualising-data-in-the-tidyverse.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb72-3"><a href="visualising-data-in-the-tidyverse.html#cb72-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Life expectancy at birth&quot;</span>)</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>Or:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="visualising-data-in-the-tidyverse.html#cb73-1" aria-hidden="true" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> plot_with_stuff_on <span class="sc">+</span> </span>
<span id="cb73-2"><a href="visualising-data-in-the-tidyverse.html#cb73-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb73-3"><a href="visualising-data-in-the-tidyverse.html#cb73-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="st">&quot;Life expectancy at birth&quot;</span>)</span>
<span id="cb73-4"><a href="visualising-data-in-the-tidyverse.html#cb73-4" aria-hidden="true" tabindex="-1"></a>final_plot</span></code></pre></div>
</div>
</div>
<div id="another-aesthetic-colour" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Another aesthetic: colour</h2>
<p>This is a simple change, but begins to highlight patterns in the data. Here I have just copied and pasted a chunk from above and added the mapping <code>colour = continent</code>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="visualising-data-in-the-tidyverse.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gap,</span>
<span id="cb74-2"><a href="visualising-data-in-the-tidyverse.html#cb74-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb74-3"><a href="visualising-data-in-the-tidyverse.html#cb74-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> lifeExp,</span>
<span id="cb74-4"><a href="visualising-data-in-the-tidyverse.html#cb74-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb74-5"><a href="visualising-data-in-the-tidyverse.html#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb74-6"><a href="visualising-data-in-the-tidyverse.html#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb74-7"><a href="visualising-data-in-the-tidyverse.html#cb74-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Life expectancy at birth&quot;</span>)</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>Can you spot any patterns in the graph?</p>
<p>A legend has appeared at the right hand side explaining what the colours represent.</p>
<p>By default the legend title is the same as the variable name. In this case it’s “continent” which is clear, but sometimes it will be something like “group_2_id” which is less pleasing on the eye (and I cringe when I see something like this in a journal article).</p>
<p>The legend title is easy to change by adding another option to <code>labs</code>:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="visualising-data-in-the-tidyverse.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gap,</span>
<span id="cb75-2"><a href="visualising-data-in-the-tidyverse.html#cb75-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb75-3"><a href="visualising-data-in-the-tidyverse.html#cb75-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> lifeExp,</span>
<span id="cb75-4"><a href="visualising-data-in-the-tidyverse.html#cb75-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb75-5"><a href="visualising-data-in-the-tidyverse.html#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-6"><a href="visualising-data-in-the-tidyverse.html#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb75-7"><a href="visualising-data-in-the-tidyverse.html#cb75-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Life expectancy at birth&quot;</span>,</span>
<span id="cb75-8"><a href="visualising-data-in-the-tidyverse.html#cb75-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Continent&quot;</span>)</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
</div>
<div id="another-geom-jitter" class="section level2 tabset" number="3.5">
<h2><span class="header-section-number">3.5</span> Another geom: jitter</h2>
<p>Making graphs often involves playing around with different ways of showing the information. Here’s the <em>jitter</em> geom, which is the same as the point geom but with “a small amount of random variation to the location of each point” (see <code>?geom_jitter</code>).</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="visualising-data-in-the-tidyverse.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gap,</span>
<span id="cb76-2"><a href="visualising-data-in-the-tidyverse.html#cb76-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb76-3"><a href="visualising-data-in-the-tidyverse.html#cb76-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> lifeExp,</span>
<span id="cb76-4"><a href="visualising-data-in-the-tidyverse.html#cb76-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb76-5"><a href="visualising-data-in-the-tidyverse.html#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb76-6"><a href="visualising-data-in-the-tidyverse.html#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb76-7"><a href="visualising-data-in-the-tidyverse.html#cb76-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Life expectancy at birth&quot;</span>,</span>
<span id="cb76-8"><a href="visualising-data-in-the-tidyverse.html#cb76-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Continent&quot;</span>)</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<div id="activity-to-develop-your-help-searching-skill" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Activity to develop your help-searching skill!</h3>
<p>How can you vary the amount of jitter?</p>
<p>Tip: you might find the help useful:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="visualising-data-in-the-tidyverse.html#cb77-1" aria-hidden="true" tabindex="-1"></a>?geom_jitter</span></code></pre></div>
<p>Alternatively, try Google.</p>
<p>If that doesn’t deliver anything useful, try <a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html#examples">this reference link</a>.</p>
</div>
<div id="answer-8" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Answer</h3>
<p>There are two options, <code>width</code> and <code>height</code>, which specify how wide the jitteriness is. Set these to zero, and the plot is indistinguishable from the point geom:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="visualising-data-in-the-tidyverse.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gap,</span>
<span id="cb78-2"><a href="visualising-data-in-the-tidyverse.html#cb78-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb78-3"><a href="visualising-data-in-the-tidyverse.html#cb78-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> lifeExp,</span>
<span id="cb78-4"><a href="visualising-data-in-the-tidyverse.html#cb78-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb78-5"><a href="visualising-data-in-the-tidyverse.html#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="dv">0</span>, <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb78-6"><a href="visualising-data-in-the-tidyverse.html#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb78-7"><a href="visualising-data-in-the-tidyverse.html#cb78-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Life expectancy at birth&quot;</span>,</span>
<span id="cb78-8"><a href="visualising-data-in-the-tidyverse.html#cb78-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Continent&quot;</span>)</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p>Here’s a little jitter added only to the width:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="visualising-data-in-the-tidyverse.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gap,</span>
<span id="cb79-2"><a href="visualising-data-in-the-tidyverse.html#cb79-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp, <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb79-3"><a href="visualising-data-in-the-tidyverse.html#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb79-4"><a href="visualising-data-in-the-tidyverse.html#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb79-5"><a href="visualising-data-in-the-tidyverse.html#cb79-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Life expectancy at birth&quot;</span>,</span>
<span id="cb79-6"><a href="visualising-data-in-the-tidyverse.html#cb79-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Continent&quot;</span>)</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
</div>
<div id="aggregatingsummarising-data-by-group" class="section level2 tabset" number="3.6">
<h2><span class="header-section-number">3.6</span> Aggregating/summarising data by group</h2>
<p>Last time, we saw how to calculate the mean of a variable. Here’s the mean of life expectancy, across all countries and years:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="visualising-data-in-the-tidyverse.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gap<span class="sc">$</span>lifeExp)</span></code></pre></div>
<pre><code>## [1] 59.47444</code></pre>
<p>I don’t know what to make of that!</p>
<p>Typically we want to calculate means by group rather than for a whole variable. This is known as <em>aggregating</em> or <em>summarising</em> by group. For instance, looking at the plots above it seems that there will be a mean difference in life expectancy between continents, and it would be interesting to see that.</p>
<p>For this, we will use <code>dplyr</code> (pronounced “DEE-ply-er”). It’s part of <code>tidyverse</code> so already included, but it’s useful to know the name of this specific part for when you are searching for help.</p>
<p>I’m going to work through an example in excruciating detail, but it will be worth it I promise.</p>
<p>The punchline is that to calculate mean life expectancy by year and continent, you do this:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="visualising-data-in-the-tidyverse.html#cb82-1" aria-hidden="true" tabindex="-1"></a>mean_life_exp_gap <span class="ot">&lt;-</span> gap <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="visualising-data-in-the-tidyverse.html#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, continent) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="visualising-data-in-the-tidyverse.html#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_life_exp =</span> <span class="fu">mean</span>(lifeExp))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;year&#39; (override with `.groups` argument)</code></pre>
<p>(Have a look and see.)</p>
<p>Here’s a longer worked example.</p>
<p><strong>Step 1.</strong> Use <code>group_by</code> to tell R what variables you want to group the data by. The first parameter of <code>group_by</code> is the dataset you want to group. The remaining parameters are the variables in that dataset to group by:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="visualising-data-in-the-tidyverse.html#cb84-1" aria-hidden="true" tabindex="-1"></a>grouped_gap <span class="ot">&lt;-</span> <span class="fu">group_by</span>(gap, year, continent)</span></code></pre></div>
<p>So this says, group the <code>gap</code> data frame by <code>year</code> and <code>continent</code>.</p>
<p>This new variable, <code>grouped_gap</code> is a <em>grouped data frame</em>. It has all the same information as before, plus a little note (semi-hidden) to say that analyses on this should be grouped.</p>
<p>Here’s how to peek at this note:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="visualising-data-in-the-tidyverse.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">group_vars</span>(grouped_gap)</span></code></pre></div>
<pre><code>## [1] &quot;year&quot;      &quot;continent&quot;</code></pre>
<p><strong>Step 2.</strong> Use <code>summarise</code> on this grouped data frame to calculate what you want. The first argument of summarise is the data frame (grouped or otherwise) followed by new variable names and what you want them to contain.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="visualising-data-in-the-tidyverse.html#cb87-1" aria-hidden="true" tabindex="-1"></a>summarised_grouped_gap <span class="ot">&lt;-</span> <span class="fu">summarise</span>(grouped_gap,</span>
<span id="cb87-2"><a href="visualising-data-in-the-tidyverse.html#cb87-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">mean_life_exp =</span> <span class="fu">mean</span>(lifeExp))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;year&#39; (override with `.groups` argument)</code></pre>
<p>Let’s have a look at the top 10 rows:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="visualising-data-in-the-tidyverse.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(summarised_grouped_gap, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 3
## # Groups:   year [2]
##     year continent mean_life_exp
##    &lt;int&gt; &lt;chr&gt;             &lt;dbl&gt;
##  1  1952 Africa             39.1
##  2  1952 Americas           53.3
##  3  1952 Asia               46.3
##  4  1952 Europe             64.4
##  5  1952 Oceania            69.3
##  6  1957 Africa             41.3
##  7  1957 Americas           56.0
##  8  1957 Asia               49.3
##  9  1957 Europe             66.7
## 10  1957 Oceania            70.3</code></pre>
<p>It worked! We could now use this in <code>ggplot</code> (and shall do so below).</p>
<div id="activity-7" class="section level3" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Activity</h3>
<p>Do the same again but this time calculate means only by year, averaging across continents.</p>
</div>
<div id="answer-9" class="section level3" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Answer</h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="visualising-data-in-the-tidyverse.html#cb91-1" aria-hidden="true" tabindex="-1"></a>grouped_gap_year <span class="ot">&lt;-</span> <span class="fu">group_by</span>(gap, year)</span>
<span id="cb91-2"><a href="visualising-data-in-the-tidyverse.html#cb91-2" aria-hidden="true" tabindex="-1"></a>summarised_grouped_year <span class="ot">&lt;-</span> <span class="fu">summarise</span>(grouped_gap_year,</span>
<span id="cb91-3"><a href="visualising-data-in-the-tidyverse.html#cb91-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">mean_life_exp =</span> <span class="fu">mean</span>(lifeExp))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="visualising-data-in-the-tidyverse.html#cb93-1" aria-hidden="true" tabindex="-1"></a>summarised_grouped_year</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##     year mean_life_exp
##    &lt;int&gt;         &lt;dbl&gt;
##  1  1952          49.1
##  2  1957          51.5
##  3  1962          53.6
##  4  1967          55.7
##  5  1972          57.6
##  6  1977          59.6
##  7  1982          61.5
##  8  1987          63.2
##  9  1992          64.2
## 10  1997          65.0
## 11  2002          65.7
## 12  2007          67.0</code></pre>
</div>
</div>
<div id="pipes" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Pipes</h2>
<p>R analyses often feel like making information flow along a pipe, transforming it in various ways as it goes. Maybe reshaping it, selecting some variables, filtering, grouping, calculating. Finally, out flows an answer.</p>
<p>This leads to another member of the tidyverse family, <code>magrittr</code>, named after René Magritte because of his <a href="https://en.wikipedia.org/wiki/The_Treachery_of_Images">1929 painting</a> showing a pipe and a caption “Ceci n’est pas une pipe” (“This is not a pipe”).</p>
<p><img src="MagrittePipe.jpg" /></p>
<p>You may have noticed that both <code>group_by</code> and <code>summarise</code> had a data frame as their first argument. They also both outputted a data frame.</p>
<p>The <em>forward pipe operator</em>, <code>%&gt;%</code>, allows you to pass the data frame along your information flow, without having to save results in interim variables.</p>
<p>You start with the name of the input data frame and then pipe it into the first function. For example, here is how to group the data:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="visualising-data-in-the-tidyverse.html#cb95-1" aria-hidden="true" tabindex="-1"></a>gap <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="visualising-data-in-the-tidyverse.html#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, continent)</span></code></pre></div>
<p>As before you can then save the result:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="visualising-data-in-the-tidyverse.html#cb96-1" aria-hidden="true" tabindex="-1"></a>grouped <span class="ot">&lt;-</span> gap <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="visualising-data-in-the-tidyverse.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, continent)</span></code></pre></div>
<p>To flow this onto summarise, just add another pipe like so:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="visualising-data-in-the-tidyverse.html#cb97-1" aria-hidden="true" tabindex="-1"></a>grouped <span class="ot">&lt;-</span> gap <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="visualising-data-in-the-tidyverse.html#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, continent) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="visualising-data-in-the-tidyverse.html#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_life_exp =</span> <span class="fu">mean</span>(lifeExp))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;year&#39; (override with `.groups` argument)</code></pre>
<p>The <code>%&gt;%</code> is purely designed to make the flow of information easier to see and hopefully also easier to design.</p>
</div>
<div id="plot-the-mean-life-expectancy-by-continent" class="section level2 tabset" number="3.8">
<h2><span class="header-section-number">3.8</span> Plot the mean life expectancy by continent</h2>
<p>By here you hopefully get the gist of how to use pipes to group data frames and summarise them. There will be further opportunities to practice this skill.</p>
<p>Here’s an aggregated data frame with mean life expectancy by year and continent:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="visualising-data-in-the-tidyverse.html#cb99-1" aria-hidden="true" tabindex="-1"></a>mean_life_exp_gap <span class="ot">&lt;-</span> gap <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="visualising-data-in-the-tidyverse.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, continent) <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="visualising-data-in-the-tidyverse.html#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_life_exp =</span> <span class="fu">mean</span>(lifeExp))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;year&#39; (override with `.groups` argument)</code></pre>
<p>You can view this to check the information is as you expect:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="visualising-data-in-the-tidyverse.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(mean_life_exp_gap)</span></code></pre></div>
<p>Here are the variable names, for ease of reference.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="visualising-data-in-the-tidyverse.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mean_life_exp_gap)</span></code></pre></div>
<pre><code>## [1] &quot;year&quot;          &quot;continent&quot;     &quot;mean_life_exp&quot;</code></pre>
<div id="actvity" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Actvity</h3>
<p>Now your challenge is to plot the mean life expectancy by year, with colour showing the continent.</p>
<p>You could try adapting an example from above to help you.</p>
</div>
<div id="answer-10" class="section level3" number="3.8.2">
<h3><span class="header-section-number">3.8.2</span> Answer</h3>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="visualising-data-in-the-tidyverse.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mean_life_exp_gap, <span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb104-2"><a href="visualising-data-in-the-tidyverse.html#cb104-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> mean_life_exp,</span>
<span id="cb104-3"><a href="visualising-data-in-the-tidyverse.html#cb104-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb104-4"><a href="visualising-data-in-the-tidyverse.html#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
</div>
</div>
<div id="yet-another-geom-line" class="section level2 tabset" number="3.9">
<h2><span class="header-section-number">3.9</span> Yet another geom: line</h2>
<p>Instead of plotting points for each year, you may wish to join the data with lines. Here’s how – just use <code>geom_line</code>:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="visualising-data-in-the-tidyverse.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mean_life_exp_gap, <span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb105-2"><a href="visualising-data-in-the-tidyverse.html#cb105-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> mean_life_exp,</span>
<span id="cb105-3"><a href="visualising-data-in-the-tidyverse.html#cb105-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb105-4"><a href="visualising-data-in-the-tidyverse.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb105-5"><a href="visualising-data-in-the-tidyverse.html#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb105-6"><a href="visualising-data-in-the-tidyverse.html#cb105-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="st">&quot;Life expectancy at birth&quot;</span>,</span>
<span id="cb105-7"><a href="visualising-data-in-the-tidyverse.html#cb105-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">colour =</span> <span class="st">&quot;Continent&quot;</span>)</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<div id="activity-8" class="section level3" number="3.9.1">
<h3><span class="header-section-number">3.9.1</span> Activity</h3>
<p>How could you add points back to the lines?</p>
</div>
<div id="answer-11" class="section level3" number="3.9.2">
<h3><span class="header-section-number">3.9.2</span> Answer</h3>
<p>Simply use “+” again:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="visualising-data-in-the-tidyverse.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mean_life_exp_gap, <span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb106-2"><a href="visualising-data-in-the-tidyverse.html#cb106-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> mean_life_exp,</span>
<span id="cb106-3"><a href="visualising-data-in-the-tidyverse.html#cb106-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb106-4"><a href="visualising-data-in-the-tidyverse.html#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb106-5"><a href="visualising-data-in-the-tidyverse.html#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<p>I’ve been a bit lazy here and haven’t bothered changing the axis labels and legend title. That is fine when playing around with different visualisations and learning. Just remember to tidy it all up before adding to a written report!</p>
</div>
</div>
<div id="filtering-data-along-the-pipeline" class="section level2 tabset" number="3.10">
<h2><span class="header-section-number">3.10</span> Filtering data along the pipeline</h2>
<p>Analysing by continent clearly doesn’t do the data justice: in the jittered points we saw there was loads of variation within continent.</p>
<p>The mean plots highlighted that improvement in life expectancy in Africa stalled around 1990. I wonder if this was the same for all countries therein?</p>
<p>The next tidyverse function we will explore to help us is called <code>filter</code>. (See the help for lots of examples using a Star Wars dataset.)</p>
<p>Here is how to filter the data so we only have rows for Africa:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="visualising-data-in-the-tidyverse.html#cb107-1" aria-hidden="true" tabindex="-1"></a>gap <span class="sc">%&gt;%</span> </span>
<span id="cb107-2"><a href="visualising-data-in-the-tidyverse.html#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Africa&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="visualising-data-in-the-tidyverse.html#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    country continent year lifeExp      pop gdpPercap
## 1  Algeria    Africa 1952  43.077  9279525  2449.008
## 2  Algeria    Africa 1957  45.685 10270856  3013.976
## 3  Algeria    Africa 1962  48.303 11000948  2550.817
## 4  Algeria    Africa 1967  51.407 12760499  3246.992
## 5  Algeria    Africa 1972  54.518 14760787  4182.664
## 6  Algeria    Africa 1977  58.014 17152804  4910.417
## 7  Algeria    Africa 1982  61.368 20033753  5745.160
## 8  Algeria    Africa 1987  65.799 23254956  5681.359
## 9  Algeria    Africa 1992  67.744 26298373  5023.217
## 10 Algeria    Africa 1997  69.152 29072015  4797.295</code></pre>
<p>Note the double equals, <code>==</code>, not to be confused with <code>=</code> which is used to set inputs (also known as arguments). To see how it works, compare:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="visualising-data-in-the-tidyverse.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">==</span> <span class="dv">14</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>And:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="visualising-data-in-the-tidyverse.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">==</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Now I’m going to try piping this filtered data frame directly into <code>ggplot</code>, without saving it. This should work because <code>ggplot</code>’s first argument is the data frame.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="visualising-data-in-the-tidyverse.html#cb113-1" aria-hidden="true" tabindex="-1"></a>gap <span class="sc">%&gt;%</span> </span>
<span id="cb113-2"><a href="visualising-data-in-the-tidyverse.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Africa&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-3"><a href="visualising-data-in-the-tidyverse.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp, <span class="at">colour =</span> country)) <span class="sc">+</span></span>
<span id="cb113-4"><a href="visualising-data-in-the-tidyverse.html#cb113-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb113-5"><a href="visualising-data-in-the-tidyverse.html#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<p>Well… it did… but the plot is very busy and I’m not sure I could distinguish between all those colours!</p>
<p>Let’s try again without the legend to see what’s going on.</p>
<p>At this point you may wonder, “How on earth will I be able to remember all these commands?” I will share a trick.</p>
<p><img src="google_hide_legend.png" /></p>
<p>Attempt 2:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="visualising-data-in-the-tidyverse.html#cb114-1" aria-hidden="true" tabindex="-1"></a>gap <span class="sc">%&gt;%</span> </span>
<span id="cb114-2"><a href="visualising-data-in-the-tidyverse.html#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Africa&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-3"><a href="visualising-data-in-the-tidyverse.html#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp, <span class="at">colour =</span> country)) <span class="sc">+</span></span>
<span id="cb114-4"><a href="visualising-data-in-the-tidyverse.html#cb114-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb114-5"><a href="visualising-data-in-the-tidyverse.html#cb114-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb114-6"><a href="visualising-data-in-the-tidyverse.html#cb114-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<div id="activity-9" class="section level3" number="3.10.1">
<h3><span class="header-section-number">3.10.1</span> Activity</h3>
<p>One of the countries’ life expectancies dropped below 25. Can you work out which one it was by using <code>filter</code>?</p>
<p>Tip: <code>==</code> was equals. You can use <code>&lt;</code> for less than.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="visualising-data-in-the-tidyverse.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">&lt;</span> <span class="dv">3</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="answer-12" class="section level3" number="3.10.2">
<h3><span class="header-section-number">3.10.2</span> Answer</h3>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="visualising-data-in-the-tidyverse.html#cb117-1" aria-hidden="true" tabindex="-1"></a>gap <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="visualising-data-in-the-tidyverse.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lifeExp <span class="sc">&lt;</span> <span class="dv">25</span>)</span></code></pre></div>
<pre><code>##   country continent year lifeExp     pop gdpPercap
## 1  Rwanda    Africa 1992  23.599 7290203  737.0686</code></pre>
<p>So the answer is Rwanda.</p>
</div>
</div>
<div id="other-handy-tools-select-slice-bind-and-arrange" class="section level2" number="3.11">
<h2><span class="header-section-number">3.11</span> Other handy tools: select, slice, bind, and arrange</h2>
<p>Often you will have datasets with a huge number of variables and will want to select a few of those to make the tables easier to read. The command for that is <code>select</code>; give it the names of the variables you want.</p>
<p>Another useful function is <code>arrange</code> which sorts a data frames by the variable(s) you provide.</p>
<p>Here is an example illustrating both. I have also added the operator <code>&amp;</code> for “and.”</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="visualising-data-in-the-tidyverse.html#cb119-1" aria-hidden="true" tabindex="-1"></a>gap <span class="sc">%&gt;%</span></span>
<span id="cb119-2"><a href="visualising-data-in-the-tidyverse.html#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span> <span class="sc">&amp;</span></span>
<span id="cb119-3"><a href="visualising-data-in-the-tidyverse.html#cb119-3" aria-hidden="true" tabindex="-1"></a>           continent <span class="sc">==</span> <span class="st">&quot;Africa&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb119-4"><a href="visualising-data-in-the-tidyverse.html#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(lifeExp) <span class="sc">%&gt;%</span></span>
<span id="cb119-5"><a href="visualising-data-in-the-tidyverse.html#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, lifeExp)</span></code></pre></div>
<pre><code>##                     country lifeExp
## 1                 Swaziland  39.613
## 2                Mozambique  42.082
## 3                    Zambia  42.384
## 4              Sierra Leone  42.568
## 5                   Lesotho  42.592
## 6                    Angola  42.731
## 7                  Zimbabwe  43.487
## 8  Central African Republic  44.741
## 9                   Liberia  45.678
## 10                   Rwanda  46.242
## 11            Guinea-Bissau  46.388
## 12         Congo, Dem. Rep.  46.462
## 13                  Nigeria  46.859
## 14                  Somalia  48.159
## 15                   Malawi  48.303
## 16            Cote d&#39;Ivoire  48.328
## 17             South Africa  49.339
## 18                  Burundi  49.580
## 19                 Cameroon  50.430
## 20                     Chad  50.651
## 21                 Botswana  50.728
## 22                   Uganda  51.542
## 23        Equatorial Guinea  51.579
## 24             Burkina Faso  52.295
## 25                 Tanzania  52.517
## 26                  Namibia  52.906
## 27                 Ethiopia  52.947
## 28                    Kenya  54.110
## 29                     Mali  54.467
## 30                 Djibouti  54.791
## 31              Congo, Rep.  55.322
## 32                   Guinea  56.007
## 33                    Benin  56.728
## 34                    Gabon  56.735
## 35                    Niger  56.867
## 36                  Eritrea  58.040
## 37                     Togo  58.420
## 38                    Sudan  58.556
## 39               Madagascar  59.443
## 40                   Gambia  59.448
## 41                    Ghana  60.022
## 42                  Senegal  63.062
## 43               Mauritania  64.164
## 44                  Comoros  65.152
## 45    Sao Tome and Principe  65.528
## 46                  Morocco  71.164
## 47                    Egypt  71.338
## 48                  Algeria  72.301
## 49                Mauritius  72.801
## 50                  Tunisia  73.923
## 51                    Libya  73.952
## 52                  Reunion  76.442</code></pre>
<p>This filters <code>gap</code> to data from 2007 <em>and</em> Africa, sorts it by life expectancy, and then selects the country and life expectancy variables.</p>
<p>The <code>slice</code> family of functions can be used to zoom into to the top or bottom slices of rows, or a random sample.</p>
<p>Here’s an example. First save the previous chunk results above in <code>africa2007</code>:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="visualising-data-in-the-tidyverse.html#cb121-1" aria-hidden="true" tabindex="-1"></a>africa2007 <span class="ot">&lt;-</span> gap <span class="sc">%&gt;%</span></span>
<span id="cb121-2"><a href="visualising-data-in-the-tidyverse.html#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span> <span class="sc">&amp;</span></span>
<span id="cb121-3"><a href="visualising-data-in-the-tidyverse.html#cb121-3" aria-hidden="true" tabindex="-1"></a>           continent <span class="sc">==</span> <span class="st">&quot;Africa&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb121-4"><a href="visualising-data-in-the-tidyverse.html#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(lifeExp) <span class="sc">%&gt;%</span></span>
<span id="cb121-5"><a href="visualising-data-in-the-tidyverse.html#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, lifeExp)</span></code></pre></div>
<p>The following R code saves the “head” of the dataset, which has the lowest life expectancies. The <code>n</code> is 3, so three rows are returned. Note the single <code>=</code> here: it’s an parameter <em>setting</em> <code>n</code> to 3 rather than an equality <code>==</code> <em>checking</em> whether <code>n</code> is 3.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="visualising-data-in-the-tidyverse.html#cb122-1" aria-hidden="true" tabindex="-1"></a>africa2007min <span class="ot">&lt;-</span> africa2007 <span class="sc">%&gt;%</span></span>
<span id="cb122-2"><a href="visualising-data-in-the-tidyverse.html#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb122-3"><a href="visualising-data-in-the-tidyverse.html#cb122-3" aria-hidden="true" tabindex="-1"></a>africa2007min</span></code></pre></div>
<pre><code>##      country lifeExp
## 1  Swaziland  39.613
## 2 Mozambique  42.082
## 3     Zambia  42.384</code></pre>
<p>Do this again for the tail, i.e., the bottom of the dataset, which is actually the highest values for life expectancy.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="visualising-data-in-the-tidyverse.html#cb124-1" aria-hidden="true" tabindex="-1"></a>africa2007max <span class="ot">&lt;-</span> africa2007 <span class="sc">%&gt;%</span></span>
<span id="cb124-2"><a href="visualising-data-in-the-tidyverse.html#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb124-3"><a href="visualising-data-in-the-tidyverse.html#cb124-3" aria-hidden="true" tabindex="-1"></a>africa2007max</span></code></pre></div>
<pre><code>##   country lifeExp
## 1 Tunisia  73.923
## 2   Libya  73.952
## 3 Reunion  76.442</code></pre>
<p>We can bind the two data frames together again using <code>bind_rows</code>:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="visualising-data-in-the-tidyverse.html#cb126-1" aria-hidden="true" tabindex="-1"></a>top_and_bottom <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(africa2007min, africa2007max)</span>
<span id="cb126-2"><a href="visualising-data-in-the-tidyverse.html#cb126-2" aria-hidden="true" tabindex="-1"></a>top_and_bottom</span></code></pre></div>
<pre><code>##      country lifeExp
## 1  Swaziland  39.613
## 2 Mozambique  42.082
## 3     Zambia  42.384
## 4    Tunisia  73.923
## 5      Libya  73.952
## 6    Reunion  76.442</code></pre>
</div>
<div id="filtering-for-members-of-a-vector" class="section level2 tabset" number="3.12">
<h2><span class="header-section-number">3.12</span> Filtering for members of a vector</h2>
<p>The <code>top_and_bottom</code> data frame has the names of countries with the top and bottom three life expectancies.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="visualising-data-in-the-tidyverse.html#cb128-1" aria-hidden="true" tabindex="-1"></a>top_and_bottom<span class="sc">$</span>country</span></code></pre></div>
<pre><code>## [1] &quot;Swaziland&quot;  &quot;Mozambique&quot; &quot;Zambia&quot;     &quot;Tunisia&quot;    &quot;Libya&quot;     
## [6] &quot;Reunion&quot;</code></pre>
<p>Next we are going to filter the data set to only these countries, using the <code>%in%</code> operator which returns true if a value is in the vector you provide and false otherwise.</p>
<p>Here are two examples:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="visualising-data-in-the-tidyverse.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Libya&quot;</span> <span class="sc">%in%</span> top_and_bottom<span class="sc">$</span>country</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="visualising-data-in-the-tidyverse.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Uganda&quot;</span> <span class="sc">%in%</span> top_and_bottom<span class="sc">$</span>country</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="visualising-data-in-the-tidyverse.html#cb134-1" aria-hidden="true" tabindex="-1"></a>gap <span class="sc">%&gt;%</span></span>
<span id="cb134-2"><a href="visualising-data-in-the-tidyverse.html#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_and_bottom<span class="sc">$</span>country) <span class="sc">%&gt;%</span></span>
<span id="cb134-3"><a href="visualising-data-in-the-tidyverse.html#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb134-4"><a href="visualising-data-in-the-tidyverse.html#cb134-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> lifeExp,</span>
<span id="cb134-5"><a href="visualising-data-in-the-tidyverse.html#cb134-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> country)) <span class="sc">+</span></span>
<span id="cb134-6"><a href="visualising-data-in-the-tidyverse.html#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<p>We can add <code>Rwanda</code> back in by using the <code>c</code> operator. Here’s an example to show how it works:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="visualising-data-in-the-tidyverse.html#cb135-1" aria-hidden="true" tabindex="-1"></a>some_numbers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb135-2"><a href="visualising-data-in-the-tidyverse.html#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(some_numbers,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<p>Back to the graph. Below I have also enlarged the <code>size</code> of the lines to make the colours easier to distinguish.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="visualising-data-in-the-tidyverse.html#cb137-1" aria-hidden="true" tabindex="-1"></a>gap <span class="sc">%&gt;%</span></span>
<span id="cb137-2"><a href="visualising-data-in-the-tidyverse.html#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(top_and_bottom<span class="sc">$</span>country, <span class="st">&quot;Rwanda&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb137-3"><a href="visualising-data-in-the-tidyverse.html#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb137-4"><a href="visualising-data-in-the-tidyverse.html#cb137-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> lifeExp,</span>
<span id="cb137-5"><a href="visualising-data-in-the-tidyverse.html#cb137-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> country)) <span class="sc">+</span></span>
<span id="cb137-6"><a href="visualising-data-in-the-tidyverse.html#cb137-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb137-7"><a href="visualising-data-in-the-tidyverse.html#cb137-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb137-8"><a href="visualising-data-in-the-tidyverse.html#cb137-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean life expectancy (years)&quot;</span>,</span>
<span id="cb137-9"><a href="visualising-data-in-the-tidyverse.html#cb137-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Country&quot;</span>)</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<p>You might now consider a qualitative analysis of these countries (or lookup Wikipedia, for the purposes of a weekly R ехеrcise) to conjecture why there are these differences.</p>
</div>
<div id="final-challenge" class="section level2 tabset" number="3.13">
<h2><span class="header-section-number">3.13</span> Final challenge</h2>
<div id="activity-10" class="section level3" number="3.13.1">
<h3><span class="header-section-number">3.13.1</span> Activity</h3>
<p>Plot life expectancy against GDP per capita for all countries in the dataset at the most recent time point. Colour the points by continent.</p>
</div>
<div id="answer-13" class="section level3" number="3.13.2">
<h3><span class="header-section-number">3.13.2</span> Answer</h3>
<p>Here’s how I did it.</p>
<p>First, check the variable names:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="visualising-data-in-the-tidyverse.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gap)</span></code></pre></div>
<pre><code>## [1] &quot;country&quot;   &quot;continent&quot; &quot;year&quot;      &quot;lifeExp&quot;   &quot;pop&quot;       &quot;gdpPercap&quot;</code></pre>
<p>So we want <code>lifeExp</code> and <code>gdpPercap</code>.</p>
<p>The most recent year is:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="visualising-data-in-the-tidyverse.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(gap<span class="sc">$</span>year)</span></code></pre></div>
<pre><code>## [1] 2007</code></pre>
<p>(You could also find that by looking at the data frame using <code>View</code>.)</p>
<p>Now make filter and make the graph in one go:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="visualising-data-in-the-tidyverse.html#cb142-1" aria-hidden="true" tabindex="-1"></a>gap <span class="sc">%&gt;%</span></span>
<span id="cb142-2"><a href="visualising-data-in-the-tidyverse.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-3"><a href="visualising-data-in-the-tidyverse.html#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb142-4"><a href="visualising-data-in-the-tidyverse.html#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb142-5"><a href="visualising-data-in-the-tidyverse.html#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Mean life expectancy (years)&quot;</span>,</span>
<span id="cb142-6"><a href="visualising-data-in-the-tidyverse.html#cb142-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;GDP per capita (US$, inflation-adjusted)&quot;</span>,</span>
<span id="cb142-7"><a href="visualising-data-in-the-tidyverse.html#cb142-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Continent&quot;</span>,</span>
<span id="cb142-8"><a href="visualising-data-in-the-tidyverse.html#cb142-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Life expectancy and GDP per capita in 2007&quot;</span>)</span></code></pre></div>
<p><img src="R-notes_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="starting-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-notes.pdf", "R-notes.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
